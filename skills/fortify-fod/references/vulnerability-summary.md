# Vulnerability Summary and Counting
**Prerequisites:** Authentication verified (see SKILL.md)

## Use Case
You need to count vulnerabilities and provide a summary breakdown by severity, category, or other groupings.

## Workflow Steps

### Step 1 - Select Release
First, identify the release to summarize. If uncertain, see [Finding Releases](find-release.md).

```tool
fcli_fod_release_get --qualifiedReleaseNameOrId "MyApp:MyRelease"
```
**Expected**: Release details including ID

---

### Step 2 - Retrieve All Issues
Get all vulnerabilities for the release:

```tool
fcli_fod_issue_list --release "MyApp:MyRelease"
```

**Expected**: List of all issues with basic information

---

### Step 3 - Count by Severity
Retrieve issues for each severity level and count them:

**Count Critical issues:**
```tool
fcli_fod_issue_list 
  --release "MyApp:MyRelease"
  --filters-param "severityString:Critical"
```

**Count High issues:**
```tool
fcli_fod_issue_list 
  --release "MyApp:MyRelease"
  --filters-param "severityString:High"
```

**Count Medium issues:**
```tool
fcli_fod_issue_list 
  --release "MyApp:MyRelease"
  --filters-param "severityString:Medium"
```

**Count Low issues:**
```tool
fcli_fod_issue_list 
  --release "MyApp:MyRelease"
  --filters-param "severityString:Low"
```

**Expected**: Each response includes `pagination.totalRecords` indicating count

Example response:
```json
{
  "pagination": {
    "totalRecords": 8,
    "hasMore": false
  },
  "records": [ /* ... */ ]
}
```

---

### Step 4 - Aggregate and Present Summary
Compile the counts into a summary for the user:

**Example Summary Presentation:**
```
Vulnerability Summary for MyApp:MyRelease
==========================================
Critical: 8
High:     15
Medium:   23
Low:      12
---------
Total:    58
```

---

### Step 5 - Count by Category (Optional)
If the user wants a breakdown by vulnerability type, retrieve issues for common categories:

**SQL Injection:**
```tool
fcli_fod_issue_list 
  --release "MyApp:MyRelease"
  --filters-param "category:SQL Injection"
```

**Cross-Site Scripting:**
```tool
fcli_fod_issue_list 
  --release "MyApp:MyRelease"
  --filters-param "category:Cross-Site Scripting"
```

**Authentication Issues:**
```tool
fcli_fod_issue_list 
  --release "MyApp:MyRelease"
  --filters-param "category:Authentication Issues"
```

**Example Category Summary:**
```
Vulnerability Breakdown by Category
====================================
SQL Injection:           12
Cross-Site Scripting:     8
Authentication Issues:    5
Path Traversal:           4
Command Injection:        3
Other:                   26
---------
Total:                   58
```

---

### Step 6 - Count Audited vs Unaudited
Show how many issues have been reviewed:

**Unaudited (not yet reviewed):**
```tool
fcli_fod_issue_list 
  --release "MyApp:MyRelease"
  --filters-param "audited:false"
```

**Audited (reviewed):**
```tool
fcli_fod_issue_list 
  --release "MyApp:MyRelease"
  --filters-param "audited:true"
```

**Example Audit Status Summary:**
```
Audit Status
============
Not Reviewed: 35
Reviewed:     23
---------
Total:        58
```

---

### Step 7 - Count Suppressed Issues
Show how many issues are suppressed:

```tool
fcli_fod_issue_list 
  --release "MyApp:MyRelease"
  --filters-param "suppressed:true"
```

**Example:**
```
Suppressed Issues: 5
Active Issues:     53
```

---

## Complete Example Flow

```tool
# 1. Verify authentication
fcli_fod_session_list refresh-cache=true

# 2. Get release details
fcli_fod_release_get --qualifiedReleaseNameOrId "MyApp:MyRelease"

# 3. Count Critical issues
fcli_fod_issue_list 
  --release "MyApp:MyRelease"
  --filters-param "severityString:Critical"

# 4. Count High issues
fcli_fod_issue_list 
  --release "MyApp:MyRelease"
  --filters-param "severityString:High"

# 5. Count Medium issues
fcli_fod_issue_list 
  --release "MyApp:MyRelease"
  --filters-param "severityString:Medium"

# 6. Count Low issues
fcli_fod_issue_list 
  --release "MyApp:MyRelease"
  --filters-param "severityString:Low"
```

**Then aggregate the `pagination.totalRecords` from each response.**

---

## Advanced: Client-Side Aggregation

If you retrieve all issues in one call, you can aggregate client-side:

```tool
fcli_fod_issue_list --release "MyApp:MyRelease"
```

**Then process the results to count:**
- Group by `severityString` field
- Group by `category` field
- Group by `audited` status
- Group by `suppressed` status

**Benefit**: Single API call
**Drawback**: Requires processing larger payload

---

## Combining Multiple Dimensions

Provide multi-dimensional summaries:

### Example: Critical Issues by Category
```tool
fcli_fod_issue_list 
  --release "MyApp:MyRelease"
  --filters-param "severityString:Critical"
```

**Then group the results by category client-side:**
```
Critical Vulnerabilities by Type
================================
SQL Injection:         3
Path Traversal:        2
Command Injection:     2
Cryptography:          1
---------
Total Critical:        8
```

---

## Trend Analysis (Comparing Scans)

To show vulnerability trends over time:

### Step 1: Get latest scan results (current)
```tool
fcli_fod_issue_list --release "MyApp:MyRelease"
```

### Step 2: Filter by found date for recent issues
```tool
fcli_fod_issue_list 
  --release "MyApp:MyRelease"
  query { "foundDate": "2026-02-.*" }
```

### Step 3: Compare counts
Present trending information:
```
Vulnerability Trends
====================
Total Issues:      58
New This Month:    12
Fixed This Month:   8
```

**Note**: Trends require historical data or multiple scans

---

## Summary Report Format Examples

### Format 1: Executive Summary
```
Security Summary for MyApp:MyRelease
=====================================
Scan Date: February 14, 2026
Total Vulnerabilities: 58

Risk Distribution:
  Critical:  8  (14%)
  High:     15  (26%)
  Medium:   23  (40%)
  Low:      12  (20%)

Top Categories:
  1. SQL Injection (12 issues)
  2. Cross-Site Scripting (8 issues)
  3. Authentication Issues (5 issues)

Action Required:
  - 8 Critical issues need immediate attention
  - 35 issues pending review
```

### Format 2: Detailed Breakdown
```
Detailed Vulnerability Report
==============================

By Severity:
  Critical: 8
  High:     15
  Medium:   23
  Low:      12
  Total:    58

By Category:
  SQL Injection:             12
  Cross-Site Scripting:       8
  Authentication Issues:      5
  Path Traversal:             4
  Command Injection:          3
  Insecure Cryptography:      2
  Sensitive Data Exposure:    3
  Other:                     21

By Status:
  Not Reviewed:    35
  Reviewed:        23
  Suppressed:       5
  Active:          53
```

---

## Troubleshooting

| Issue | Solution |
|-------|----------|
| "Release not found" | Verify release name with `fcli_fod_release_list` (see [Finding Releases](find-release.md)) |
| "No issues found" | Verify scans have completed; check with scan status commands |
| "Counts don't match" | Check for pagination; ensure all pages retrieved |
| "Category name invalid" | List actual issues to see available category values |
| "Session expired" | Re-authenticate: `fcli fod session login --url <URL> --client-id <id> --client-secret <secret>` |

---

## Best Practices

✅ **DO:**
- Use server-side filtering with `--filters-param` for efficiency
- Check `pagination.totalRecords` for counts (don't need to retrieve all records)
- Present summary in user-friendly format
- Include percentage breakdowns for clarity
- Highlight critical and high severity issues

❌ **DO NOT:**
- Retrieve all issue details when only counting (omit `--embed` to save bandwidth)
- Ignore pagination - may miss issues in large datasets
- Present raw API responses to users - format them nicely
- Forget to check for zero counts (handle gracefully)

---

## Related Workflows

- **View detailed issues**: See [List and Filter Vulnerabilities](list-filter-vulnerabilities.md)
- **Get remediation advice**: See [Remediation Workflow](remediation-workflow.md)
- **Find correct release**: See [Finding Releases](find-release.md)

---

## Performance Tips

### Tip 1: Count Without Details
When only counting, don't use `--embed` to reduce payload size:
```tool
# Fast - just count
fcli_fod_issue_list 
  --release "MyApp:MyRelease"
  --filters-param "severityString:Critical"

# Slower - includes unnecessary details
fcli_fod_issue_list 
  --release "MyApp:MyRelease"
  --filters-param "severityString:Critical"
  --embed "details,recommendations"
```

### Tip 2: Parallel Queries
If making multiple severity queries, explain you're counting each level separately for completeness.

### Tip 3: Use totalRecords
The `pagination.totalRecords` field gives you the count without needing to retrieve all records:
```json
{
  "pagination": {
    "totalRecords": 8,
    "hasMore": false
  }
}
```
Use this value directly instead of counting records manually.
